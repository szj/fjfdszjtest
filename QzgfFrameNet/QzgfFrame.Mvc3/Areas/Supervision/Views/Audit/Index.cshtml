<!--审核工单列表-->
    <script type="text/javascript">
        //debugger; 调试时使用
        var gridManager0 = null;
        var gridManager1 = null;
        var activeDialog = null;
        //该功能选项菜单id
        var frameId = GetUrlParam('_menuid');

        function f_openWindow(url, title, width, height) {
            var dialogOptions = { width: width, height: height, title: title, url: url, buttons: [
            { text: '保存', onclick: function (item, dialog) {
                dialog.frame.f_save(); //f_save调用的是弹出框调用页的方法
                dialog.close(); //关闭添加窗口
                f_reload(); //刷新数据
                //debugger;
            }
            },
            { text: '关闭', onclick: function (item, dialog) {
                dialog.close();
            }
            }
            ], isResize: true, timeParmName: 'a'
            };
            activeDialog = parent.jQuery.ligerDialog.open(dialogOptions);
        }
        function f_closeWindow(reload) {
            activeDialog && activeDialog.close();
            reload && f_reload();
        }

        //显示审核工单弹出框
        function f_Approval(id) {
            f_openWindow('/Supervision/Audit/Approval/' + id, '审批工单', 600, 350);
        }

        //查看
        function f_Detailed(id) {
            f_openWindow('/Supervision/Audit/Detailed/' + id, '查看', 600, 350);
        }

        //初始化列表
        $(function () {
            f_setToolbar();
            f_setGrid();
        });

        //设置操作按钮
        function f_setToolbar() {
            SetButtons($("#toolbar1"), "/system/menu/GetButton?menuid=20111123113102500342");
            SetButtons($("#toolbar2"), "/system/menu/GetButton?menuid=20111123113102500342");
        }

        //设置列表
        function f_setGrid() {
            //未审核工单
            gridManager0 = $("#maingrid1").ligerGrid({
                columns: [
                { display: '操作', name: 'ApprovalOperating', align: 'center', width: 90, minWidth: 60 },
                { display: '工单号', name: 'Id', align: 'left', width: 150, minWidth: 60 },
                { display: '工单主题', name: 'SendTitle', align: 'left', width: 130, minWidth: 60 },
                { display: '工单内容', name: 'SendContent', align: 'left', width: 130, minWidth: 60 },
                { display: '派单时间', name: 'DispatchTime', align: 'left', width: 130, minWidth: 60 }
                ], dataAction: 'server',
                url: "/Supervision/Audit/GridPager", sortName: 'id',
                width: '99%', height: '100%', pageSize: 30,
                heightDiff: -9,
                parms: [{ name: "gridsearch", value: "ApprovalStatus='0',Status='2'"}],
                onError: function (a, b) {
                    debugger
                }
            });

            //已审核工单
            gridManager1 = $("#maingrid2").ligerGrid({
                columns: [
                { display: '操作', name: 'ApprovalOperating', align: 'center', width: 90, minWidth: 60 },
                { display: '是否通过', name: 'Status', align: 'center', width: 90, minWidth: 60 },
                { display: '工单号', name: 'Id', align: 'left', width: 150, minWidth: 60 },
                { display: '工单主题', name: 'SendTitle', align: 'left', width: 130, minWidth: 60 },
                { display: '工单内容', name: 'SendContent', align: 'left', width: 130, minWidth: 60 },
                { display: '派单时间', name: 'DispatchTime', align: 'left', width: 130, minWidth: 60 }
                ], dataAction: 'server',
                url: "/Supervision/Audit/GridPager", sortName: 'id',
                width: '99%', height: '100%', pageSize: 30,
                parms: [{ name: "gridsearch", value: "ApprovalStatus='1',Status='4'/Status='3'"}],
                heightDiff: -9,
                onError: function (a, b) {
                    debugger
                }
            });

        }
        function f_reload() {
            gridManager0 && gridManager0.loadData(true);
            gridManager1 && gridManager1.loadData(true);
        }
    </script>
<form id="form1" runat="server">

    <ul id="countrytabs" class="shadetabs">
        <li><a href="#" rel="country1" class="selected">未审核工单</a></li>
        <li><a href="#" rel="country2">已审核工单</a></li>
    </ul>
    <div style="border:1px solid gray; margin-bottom: 1em; padding: 10px">
        <div id="country1" class="tabcontent" style="width:800px">
            <div id="maingrid1"></div>
        </div>
        <div id="country2" class="tabcontent" style="width:800px">
            <div id="maingrid2"></div>
        </div>
    </div>
    <script type="text/javascript">
        var countries = new ddtabcontent("countrytabs")
        countries.setpersist(true)
        countries.setselectedClassTarget("link") //"link" or "linkparent"
        countries.init()
    </script>
</form>
