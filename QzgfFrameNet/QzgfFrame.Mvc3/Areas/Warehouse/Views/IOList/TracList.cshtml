<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
     <link href="../../../../Lib/ligerUI/skins/Silvery/css/ligerui-common.css" rel="stylesheet" type="text/css" /> 
    <link href="../../../../Lib/ligerUI/skins/Silvery/css/ligerui-dialog.css" rel="stylesheet" type="text/css" />
    <link href="../../../../Lib/ligerUI/skins/Silvery/css/ligerui-grid.css" rel="stylesheet"  type="text/css" />
    <link href="../../../../Lib/ligerUI/skins/Silvery/css/ligerui-form.css" rel="stylesheet" type="text/css" />
    <link href="../../../../Lib/ligerUI/skins/ligerui-icons.css" rel="stylesheet" type="text/css" />
    <script src="../../../../Lib/jquery/jquery-1.3.2.min.js" type="text/javascript"></script>
    <script src="../../../../Lib/ligerUI/js/ligerui.all.js" type="text/javascript"></script>  
    <script src="../../../../Content/Lib/js/common.js" type="text/javascript"></script>
    <link href="../../../../Content/Lib/css/EditStyle.css" rel="stylesheet" type="text/css" />

    <script type="text/javascript">
        //debugger; 调试时使用
        var apgridManager = null;
        var wcgridManager = null;
        var rbgridManager = null;
        var wrgridManager = null;
        var yrgridManager = null;

        var activeDialog = null;
        var frameId = GetUrlParam('_menuid');
        var saveFrameId = "qzgfframe" + GetUrlParam('_menuid');
        function f_openWindow(url, title, width, height) {
            var dialogOptions = { width: width, height: height, title: title, url: url, buttons: [
            { text: '保存', onclick: function (item, dialog) {
                dialog.frame.f_save();
                f_reload(); //刷新数据
                dialog.close();
                //debugger;
            }
            },
            { text: '关闭', onclick: function (item, dialog) {
                dialog.close();
            }
            }
            ], isResize: true, timeParmName: 'a'
            };
            activeDialog = parent.jQuery.ligerDialog.open(dialogOptions);
        }
        function f_closeWindow(reload) {
            activeDialog && activeDialog.close();
            reload && f_reload();
        }
        function f_btnClick(item) {
            switch (item.id) {
                case "add":
                    f_add();
                    break;
                case "modify":
                    f_modify();
                    break;
                case "delete":
                    f_delete();
                    break;
                case "loadfile":
                    f_loadfile();
                    break;
                case "button":
                    f_button();
                    break;
            }
        }
        function f_button() {
            var rowsdata = gridManager.getCheckedRows();
            if (!rowsdata.length) {
                $.ligerDialog.alert('请先选择行!');
                return;
            }
            var id = rowsdata[0].ID;
            f_openWindow('system/ButtonList.aspx?CurID=' + id, '菜单操作管理', 600, 350);
        }
        function f_add() {
            window.location.href = "/Warehouse/IOList/Add/?TypeName=Trac&id=0&frameid=" + frameId;
            //f_openWindow('/Warehouse/IOList/edit/0', '添加菜单', 800, 350);
        }
        function f_loadfile() {
            f_openWindow('/Warehouse/IOList/LoadFile/', '专线设备信息导入', 800, 350);
        }
        function f_addTab(tabid, text, url) {
            tab.addTabItem({ tabid: tabid, text: text, url: url });
        }
        function f_modify() {
            var rowsdata = gridManager.getCheckedRows();
            if (rowsdata.length != 1) {
                $.ligerDialog.alert('请选择一行记录!');
                return;
            }
            var id = rowsdata[0].Id;
            window.location.href = "/Warehouse/IOList/Modify/?TypeName=Trac&id=" + id + "&frameid=" + frameId;
        }
        function f_delete() {
            var rowsdata = gridManager.getCheckedRows();
            if (!rowsdata.length) {
                $.ligerDialog.alert('请先选择行!');
                return;
            }

            $.ligerDialog.confirm("是否确认删除?", "提示", function (ok) {
                if (ok) {
                    $.ligerDialog.waitting("正在删除中...");
                    var idStr = "";
                    $(rowsdata).each(function (i, item) {
                        idStr += this.Id;
                        if (i < rowsdata.length - 1) idStr += ",";
                    });
                    $.getJSON('/Warehouse/IOList/delete/?id=' + idStr, { Rnd: Math.random() }, function (data) {
                        if (data.Type) {
                            $.ligerDialog.success("删除成功");
                        }
                        else {
                            $.ligerDialog.error("删除失败!<BR>" + data.Message);
                        }
                        $.ligerDialog.closeWaitting();
                        f_reload();
                    });
                } else {
                    return;
                }
            });

        }
        $(function () {
            $(".tabmenu .table1 td:first").addClass("current"); //为第一个SPAN添加当前效果样式 
            $(".tabmenu ul li:not(:first)").hide(); //隐藏其它的UL 
            $(".tabmenu .table1 .tab_tit").click(function () {
                $(".tabmenu .table1 td").removeClass("current"); //去掉所有SPAN的样式 
                $(this).addClass("current");
                $(".tabmenu ul li").hide();
                $("." + $(this).attr("id")).show();
            });

            f_setToolbar();
            f_setGrid();
        });
        function f_setToolbar() {
            SetButtons($("#applytoolbar"), "/system/menu/GetButton?menuid=20111118154434457901");
            SetButtons($("#wconfirmtoolbar"), "/system/menu/GetButton?menuid=20111118154434457901");
            SetButtons($("#rebacktoolbar"), "/system/menu/GetButton?menuid=20111118154434457901");
            SetButtons($("#wreceivetoolbar"), "/system/menu/GetButton?menuid=20111118154434457901");
            SetButtons($("#yreceivetoolbar"), "/system/menu/GetButton?menuid=20111118154434457901");
        }
        function f_setGrid() {
            apgridManager = $("#applymaingrid").ligerGrid({
                columns: [
                { display: '收货人员', name: 'Operator', align: 'left', width: 130, minWidth: 60 },
                { display: '数量', name: 'TotalNum', align: 'left', width: 130, minWidth: 60 },
                { display: '入库时间', name: 'IODate', type: 'date', align: 'left', width: 130, minWidth: 60 }
                ], dataAction: 'server',
                url: "/Warehouse/IOList/gridpager", sortName: 'id',
                width: '99%', height: '100%', pageSize: 30,
                checkbox: true,
                heightDiff: -9,
                onError: function (a, b) {
                    debugger
                }
            });
            wcgridManager = $("#wconfirmmaingrid").ligerGrid({
                columns: [
                { display: '收货人员', name: 'Operator', align: 'left', width: 130, minWidth: 60 },
                { display: '数量', name: 'TotalNum', align: 'left', width: 130, minWidth: 60 },
                { display: '入库时间', name: 'IODate', type: 'date', align: 'left', width: 130, minWidth: 60 }
                ], dataAction: 'server',
                url: "/Warehouse/IOList/gridpager", sortName: 'id',
                width: '99%', height: '100%', pageSize: 30,
                checkbox: true,
                heightDiff: -9,
                onError: function (a, b) {
                    debugger
                }
            });
            rbgridManager = $("#rebackmaingrid").ligerGrid({
                columns: [
                { display: '收货人员', name: 'Operator', align: 'left', width: 130, minWidth: 60 },
                { display: '数量', name: 'TotalNum', align: 'left', width: 130, minWidth: 60 },
                { display: '入库时间', name: 'IODate', type: 'date', align: 'left', width: 130, minWidth: 60 }
                ], dataAction: 'server',
                url: "/Warehouse/IOList/gridpager", sortName: 'id',
                width: '99%', height: '100%', pageSize: 30,
                checkbox: true,
                heightDiff: -9,
                onError: function (a, b) {
                    debugger
                }
            });
            wrgridManager = $("#wreceivemaingrid").ligerGrid({
                columns: [
                { display: '收货人员', name: 'Operator', align: 'left', width: 130, minWidth: 60 },
                { display: '数量', name: 'TotalNum', align: 'left', width: 130, minWidth: 60 },
                { display: '入库时间', name: 'IODate', type: 'date', align: 'left', width: 130, minWidth: 60 }
                ], dataAction: 'server',
                url: "/Warehouse/IOList/gridpager", sortName: 'id',
                width: '99%', height: '100%', pageSize: 30,
                checkbox: true,
                heightDiff: -9,
                onError: function (a, b) {
                    debugger
                }
            });
            yrgridManager = $("#yreceivemaingrid").ligerGrid({
                columns: [
                { display: '收货人员', name: 'Operator', align: 'left', width: 130, minWidth: 60 },
                { display: '数量', name: 'TotalNum', align: 'left', width: 130, minWidth: 60 },
                { display: '入库时间', name: 'IODate', type: 'date', align: 'left', width: 130, minWidth: 60 }
                ], dataAction: 'server',
                url: "/Warehouse/IOList/gridpager", sortName: 'id',
                width: '99%', height: '100%', pageSize: 30,
                checkbox: true,
                heightDiff: -9,
                onError: function (a, b) {
                    debugger
                }
            });
        }
        function f_reload() {
            gridManager && gridManager.loadData(true);
        }
    </script>
    <style type="text/css"> 
        .maingrid{ margin:0 0;}
        .toolbar{margin:0px 0;width:99%; background:#F3F8F9;border: 1px solid #B6D3E0; height:30px; line-height:30px;}
        
    </style>
</head>
<body>
    <form id="form1" runat="server">
     <div class="tabmenu" > 
  <table width="100%" class="table1"><tr>
  <td id="apply" class="tab_tit">申请调拨</td>
  <td id="wconfirm" class="tab_tit">待确认调拨</td>  
  <td id="reback" class="tab_tit">被退回调拨</td>
  <td id="wreceive" class="tab_tit">待接收调拨</td>
  <td id="yreceive" class="tab_tit">已接收调拨</td>
  <td >&nbsp;</td>
  </tr>
  </table>
    <ul class="ulIndex" style=" clear:both">
<li class="apply">
    <div id="applytoolbar" class="toolbar"></div>
    <div id="applymaingrid" class="maingrid"></div>
</li>
<li class="wconfirm"> 
    <div id="wconfirmtoolbar"class="toolbar"></div>
    <div id="wconfirmmaingrid" class="maingrid"></div>
</li>
<li class="reback">
    <div id="rebacktoolbar"class="toolbar"></div>
    <div id="rebackmaingrid" class="maingrid"></div>
</li>
<li class="wreceive"> 
    <div id="wreceivetoolbar"class="toolbar"></div>
    <div id="wreceivemaingrid" class="maingrid"></div>
</li>

<li class="yreceive">
    <div id="yreceivetoolbar"class="toolbar"></div>
    <div id="yreceivemaingrid" class="maingrid"></div>
</li>
    </ul>
    </div>
    </form>
</body>
</html>
